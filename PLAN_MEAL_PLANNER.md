# ĞŸĞ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸: Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ² Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ ğŸ½

**Ğ”Ğ°Ñ‚Ğ°:** 2026-01-07
**ĞœĞµÑ‚Ğ¾Ğ´Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ:** Spec-Driven Development
**Ğ¦ĞµĞ»ÑŒ:** Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ² Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ sport_kt

---

## ğŸ“‹ ĞĞ±Ğ·Ğ¾Ñ€

Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ² Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ Ñ ÑƒÑ‡Ñ‘Ñ‚Ğ¾Ğ¼:
- Ğ¦ĞµĞ»ĞµĞ²Ñ‹Ñ… ĞšĞ‘Ğ–Ğ£ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (ÑƒĞ¶Ğµ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ² app)
- Ğ¦ĞµĞ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (weight_loss / muscle_gain)
- ĞĞ»Ğ»ĞµÑ€Ğ³Ğ¸Ğ¹ Ğ¸ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²
- Ğ”Ğ¸ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¿Ñ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ñ‚ĞµĞ½Ğ¸Ğ¹ (Ğ²ĞµĞ³Ğ°Ğ½, Ğ²ĞµĞ³ĞµÑ‚Ğ°Ñ€Ğ¸Ğ°Ğ½ĞµÑ†, Ğ±ĞµĞ· Ğ³Ğ»ÑÑ‚ĞµĞ½Ğ° Ğ¸ Ñ‚.Ğ´.)
- Ğ Ğ°Ğ·Ğ½Ğ¾Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¸Ñ Ğ¼ĞµĞ½Ñ Ğ½Ğ° 4 Ğ½ĞµĞ´ĞµĞ»Ğ¸

## ğŸ¯ ĞĞ´Ğ°Ğ¿Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ´ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ

### Ğ§Ñ‚Ğ¾ Ğ£Ğ–Ğ• ĞµÑÑ‚ÑŒ Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸:
1. **ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ Ñ Ñ†ĞµĞ»ÑĞ¼Ğ¸** (User.goal: 'weight_loss' | 'muscle_gain')
2. **Ğ Ğ°ÑÑ‡ĞµÑ‚ ĞšĞ‘Ğ–Ğ£** - Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚ ĞºĞ°Ğ»Ğ¾Ñ€Ğ¸Ğ¹ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ²ĞµÑĞ° Ğ¸ Ñ†ĞµĞ»Ğ¸:
   - weight_loss: Ğ²ĞµÑ Ã— 29
   - muscle_gain: Ğ²ĞµÑ Ã— 36 + 500 ĞºĞºĞ°Ğ»
3. **Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğµ Ñ‡ĞµĞºĞ¸Ğ½Ñ‹** - Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ (DailyCheckin.nutrition)
4. **Ğ•Ğ¶ĞµĞ½ĞµĞ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ·Ğ°Ğ¼ĞµÑ€Ñ‹** - Ğ²ĞµÑ, Ğ¾Ğ±ÑŠĞµĞ¼Ñ‹ (WeeklyMeasurement)
5. **ĞšÑƒÑ€Ñ Ğ½Ğ° 16 Ğ½ĞµĞ´ĞµĞ»ÑŒ** (MAX_COURSE_WEEKS = 16)
6. **Telegram Ğ±Ğ¾Ñ‚** Ñ Telegram Mini App Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹
7. **Brutal cyberpunk Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½** (dark void, neon colors)

### Ğ§Ñ‚Ğ¾ ĞĞ• Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¸Ğ· Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ°:
1. âŒ Ğ¡Ğ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ TDEE ĞºĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚ ĞšĞ‘Ğ–Ğ£)
2. âŒ ĞÑ‚Ğ´ĞµĞ»ÑŒĞ½Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° clients (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ users)
3. âŒ PDF Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ (Ğ¿Ğ¾ĞºĞ° Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ°, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¶Ğµ)
4. âŒ Ğ‘ÑĞ´Ğ¶ĞµÑ‚Ğ½Ñ‹Ğµ ÑƒÑ€Ğ¾Ğ²Ğ½Ğ¸ (Ğ¿Ğ¾ĞºĞ° Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹)
5. âŒ Telegram HTTP ĞºĞ»Ğ¸ĞµĞ½Ñ‚ Ğ¸Ğ· Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ° (Ñƒ Ğ½Ğ°Ñ ÑĞ²Ğ¾Ğ¹ Ğ±Ğ¾Ñ‚)

### Ğ§Ñ‚Ğ¾ Ğ‘Ğ•Ğ Ğ•Ğœ Ğ¸Ğ· Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ°:
1. âœ… Ğ‘Ğ°Ğ·Ğ° Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ñ ĞšĞ‘Ğ–Ğ£ (products)
2. âœ… Ğ ĞµÑ†ĞµĞ¿Ñ‚Ñ‹ (recipes + recipe_items)
3. âœ… Ğ¢ĞµĞ³Ğ¸ (tags) - Ğ°Ğ»Ğ»ĞµÑ€Ğ³ĞµĞ½Ñ‹, Ğ´Ğ¸ĞµÑ‚Ñ‹, Ğ¿Ñ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ
4. âœ… ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ² (meal_generator.py â†’ TypeScript)
5. âœ… Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ² (meal_plans, meal_days, meals)
6. âœ… Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑĞ¾Ğ² Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ°Ğ¼ Ğ¿Ğ¸Ñ‰Ğ¸
7. âœ… ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº

---

## ğŸ“Š Ğ“Ğ¸Ğ±Ñ€Ğ¸Ğ´Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ FatSecret API

### **Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ˜Ğ¡Ğ¢ĞĞ§ĞĞ˜ĞšĞ˜ ĞŸĞ ĞĞ”Ğ£ĞšĞ¢ĞĞ’                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. USDA FoodData Central (Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ±Ğ°Ğ·Ğ°)                     â”‚
â”‚     â””â”€ 500-1000 Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²                              â”‚
â”‚     â””â”€ Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ñ‡ĞµÑ€ĞµĞ· CSV Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ·                               â”‚
â”‚     â””â”€ 100% Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾, Ğ±ĞµĞ· API                                 â”‚
â”‚                                                                 â”‚
â”‚  2. FatSecret API (Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸) â­                     â”‚
â”‚     â””â”€ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ Ğ¸Ñ‰ÑƒÑ‚ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹ Ğ² real-time                  â”‚
â”‚     â””â”€ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ² Ğ‘Ğ” Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ                   â”‚
â”‚     â””â”€ ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²                                 â”‚
â”‚     â””â”€ 5,000 Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²/Ğ´ĞµĞ½ÑŒ (Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾)                         â”‚
â”‚                                                                 â”‚
â”‚  3. Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ‘Ğ” PostgreSQL (ĞºÑÑˆ + Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ)                  â”‚
â”‚     â””â”€ Ğ‘Ğ°Ğ·Ğ° Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸                               â”‚
â”‚     â””â”€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ±ĞµĞ· Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… API                          â”‚
â”‚     â””â”€ Ğ”ĞµĞ´ÑƒĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TELEGRAM MINI APP (Frontend)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¿Ğ»Ğ°Ğ½Ğ° Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ (Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° 4 Ğ½ĞµĞ´ĞµĞ»Ğ¸)                   â”‚
â”‚  - ğŸ” ĞŸĞĞ˜Ğ¡Ğš Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² (FatSecret API)                          â”‚
â”‚  - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹/Ğ°Ğ»Ğ»ĞµÑ€Ğ³Ğ¸Ğ¹ + Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²                 â”‚
â”‚  - ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ² Ñ Ğ·Ğ°Ğ¼ĞµĞ½Ğ¾Ğ¹ Ğ¸Ğ½Ğ³Ñ€ĞµĞ´Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²                    â”‚
â”‚  - Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº (Ğ¼ĞµÑÑÑ‡Ğ½Ñ‹Ğ¹ + Ğ¿Ğ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¾)                      â”‚
â”‚  - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ/Ñ€ĞµĞ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ°                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTP API
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Express Backend (Node.js)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  /api/nutrition/meal-plans          - CRUD Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ²              â”‚
â”‚  /api/nutrition/generate            - Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ°          â”‚
â”‚  /api/nutrition/recipes             - Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ²        â”‚
â”‚  /api/nutrition/products/search     - ğŸ” Ğ¿Ğ¾Ğ¸ÑĞº (FatSecret)     â”‚
â”‚  /api/nutrition/products/local      - Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ‘Ğ”             â”‚
â”‚  /api/nutrition/tags                - Ñ‚ĞµĞ³Ğ¸ (Ğ°Ğ»Ğ»ĞµÑ€Ğ³Ğ¸Ğ¸/Ğ´Ğ¸ĞµÑ‚Ñ‹)    â”‚
â”‚  /api/nutrition/shopping-list/:id   - ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº           â”‚
â”‚  /api/nutrition/exclusions          - ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                   â”‚
            â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Meal Plan Generator      â”‚    â”‚  Nutrition Data Service     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Macro Distributor     â”‚    â”‚  - FatSecret OAuth 2.0      â”‚
â”‚  2. Recipe Selector       â”‚    â”‚  - Product search           â”‚
â”‚  3. Portion Optimizer     â”‚    â”‚  - Auto-import to DB        â”‚
â”‚  4. Diversity Checker     â”‚    â”‚  - Cache management         â”‚
â”‚  5. Shopping Aggregator   â”‚    â”‚  - Deduplication            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PostgreSQL Database (Railway)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹:                                                      â”‚
â”‚  - products (Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ‘Ğ”, Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸)                â”‚
â”‚  - tags, product_tags                                           â”‚
â”‚  - fatsecret_cache (ĞºÑÑˆ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ¸ÑĞºĞ°)                     â”‚
â”‚                                                                 â”‚
â”‚  Ğ ĞµÑ†ĞµĞ¿Ñ‚Ñ‹:                                                       â”‚
â”‚  - recipes, recipe_items, recipe_tags                           â”‚
â”‚                                                                 â”‚
â”‚  ĞŸĞ»Ğ°Ğ½Ñ‹:                                                         â”‚
â”‚  - meal_plans, meal_days, meals                                 â”‚
â”‚  - user_excluded_tags, user_excluded_products                   â”‚
â”‚  - shopping_list_items                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ Ğ¡Ñ…ĞµĞ¼Ğ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (ĞĞ¾Ğ²Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹)

### 1. products (ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹)
```sql
CREATE TABLE products (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(200) NOT NULL,                 -- ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°
  name_short VARCHAR(50),                     -- ĞšĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ

  -- ĞšĞ‘Ğ–Ğ£ Ğ½Ğ° 100Ğ³
  calories DECIMAL(6,2) NOT NULL,             -- ĞºĞºĞ°Ğ»
  protein DECIMAL(5,2) NOT NULL,              -- Ğ±ĞµĞ»Ğ¾Ğº (Ğ³)
  fat DECIMAL(5,2) NOT NULL,                  -- Ğ¶Ğ¸Ñ€ (Ğ³)
  carbs DECIMAL(5,2) NOT NULL,                -- ÑƒĞ³Ğ»ĞµĞ²Ğ¾Ğ´Ñ‹ (Ğ³)
  fiber DECIMAL(5,2) DEFAULT 0,               -- ĞºĞ»ĞµÑ‚Ñ‡Ğ°Ñ‚ĞºĞ° (Ğ³)

  category VARCHAR(50) NOT NULL,              -- meat, poultry, fish, grains...
  is_perishable BOOLEAN DEFAULT true,         -- ÑĞºĞ¾Ñ€Ğ¾Ğ¿Ğ¾Ñ€Ñ‚ÑÑ‰Ğ¸Ğ¹ÑÑ
  cooking_ratio DECIMAL(3,2) DEFAULT 1.0,     -- ĞºĞ¾ÑÑ„. Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ¸ (Ğ³Ñ€ĞµÑ‡ĞºĞ° Ã—3)

  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP
);

CREATE INDEX idx_products_category ON products(category);
CREATE INDEX idx_products_active ON products(is_active) WHERE is_active = true;
```

### 2. tags (Ğ¢ĞµĞ³Ğ¸: Ğ°Ğ»Ğ»ĞµÑ€Ğ³ĞµĞ½Ñ‹, Ğ´Ğ¸ĞµÑ‚Ñ‹)
```sql
CREATE TYPE tag_type AS ENUM ('allergen', 'diet', 'preference');

CREATE TABLE tags (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(50) UNIQUE NOT NULL,           -- lactose, gluten, vegan...
  name_ru VARCHAR(100) NOT NULL,              -- Ğ›Ğ°ĞºÑ‚Ğ¾Ğ·Ğ°, Ğ“Ğ»ÑÑ‚ĞµĞ½, Ğ’ĞµĞ³Ğ°Ğ½...
  type tag_type NOT NULL,
  description TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Ğ¡Ğ²ÑĞ·ÑŒ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚-Ñ‚ĞµĞ³
CREATE TABLE product_tags (
  product_id UUID REFERENCES products(id) ON DELETE CASCADE,
  tag_id UUID REFERENCES tags(id) ON DELETE CASCADE,
  PRIMARY KEY (product_id, tag_id)
);

CREATE INDEX idx_product_tags_tag ON product_tags(tag_id);
```

### 3. recipes (Ğ ĞµÑ†ĞµĞ¿Ñ‚Ñ‹)
```sql
CREATE TYPE meal_type AS ENUM ('breakfast', 'lunch', 'dinner', 'snack');
CREATE TYPE recipe_complexity AS ENUM ('simple', 'medium', 'complex');

CREATE TABLE recipes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(200) NOT NULL,
  name_short VARCHAR(100),                    -- ĞšĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğµ Ğ´Ğ»Ñ Ğ¼ĞµĞ½Ñ

  meal_type meal_type NOT NULL,               -- Ñ‚Ğ¸Ğ¿ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ° Ğ¿Ğ¸Ñ‰Ğ¸
  cooking_time INT,                           -- Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹
  instructions TEXT,                          -- Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ

  servings INT DEFAULT 1,                     -- Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ğ¹
  is_scalable BOOLEAN DEFAULT true,           -- Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
  complexity recipe_complexity DEFAULT 'simple',

  -- ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ĞšĞ‘Ğ–Ğ£ Ğ½Ğ° 1 Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ñ (Ğ°Ğ²Ñ‚Ğ¾Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ)
  cached_calories DECIMAL(7,2),
  cached_protein DECIMAL(6,2),
  cached_fat DECIMAL(6,2),
  cached_carbs DECIMAL(6,2),

  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP
);

CREATE INDEX idx_recipes_meal_type ON recipes(meal_type);
CREATE INDEX idx_recipes_active ON recipes(is_active) WHERE is_active = true;

-- Ğ˜Ğ½Ğ³Ñ€ĞµĞ´Ğ¸ĞµĞ½Ñ‚Ñ‹ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ°
CREATE TABLE recipe_items (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  recipe_id UUID REFERENCES recipes(id) ON DELETE CASCADE,
  product_id UUID REFERENCES products(id),

  amount_grams DECIMAL(7,2) NOT NULL,         -- ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ² Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°Ñ…
  is_optional BOOLEAN DEFAULT false,
  notes VARCHAR(200),                         -- "Ğ² ÑÑƒÑ…Ğ¾Ğ¼ Ğ²Ğ¸Ğ´Ğµ"

  FOREIGN KEY (recipe_id) REFERENCES recipes(id) ON DELETE CASCADE
);

CREATE INDEX idx_recipe_items_recipe ON recipe_items(recipe_id);

-- Ğ¡Ğ²ÑĞ·ÑŒ Ñ€ĞµÑ†ĞµĞ¿Ñ‚-Ñ‚ĞµĞ³
CREATE TABLE recipe_tags (
  recipe_id UUID REFERENCES recipes(id) ON DELETE CASCADE,
  tag_id UUID REFERENCES tags(id) ON DELETE CASCADE,
  PRIMARY KEY (recipe_id, tag_id)
);

CREATE INDEX idx_recipe_tags_tag ON recipe_tags(tag_id);
```

### 4. user_exclusions (Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ)
```sql
-- Ğ˜ÑĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµĞ³Ğ¸ (Ğ°Ğ»Ğ»ĞµÑ€Ğ³Ğ¸Ğ¸/Ğ´Ğ¸ĞµÑ‚Ñ‹)
CREATE TABLE user_excluded_tags (
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  tag_id UUID REFERENCES tags(id) ON DELETE CASCADE,
  created_at TIMESTAMP DEFAULT NOW(),
  PRIMARY KEY (user_id, tag_id)
);

-- Ğ˜ÑĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹ (ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ)
CREATE TABLE user_excluded_products (
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  product_id UUID REFERENCES products(id) ON DELETE CASCADE,
  created_at TIMESTAMP DEFAULT NOW(),
  PRIMARY KEY (user_id, product_id)
);
```

### 5. meal_plans (ĞŸĞ»Ğ°Ğ½Ñ‹ Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ)
```sql
CREATE TYPE meal_plan_status AS ENUM ('draft', 'active', 'archived');

CREATE TABLE meal_plans (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,

  weeks INT DEFAULT 4,                        -- ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ½ĞµĞ´ĞµĞ»ÑŒ
  status meal_plan_status DEFAULT 'draft',

  -- Ğ¦ĞµĞ»ĞµĞ²Ñ‹Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑÑ‹ (Ğ½Ğ° Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸)
  target_calories INT NOT NULL,
  target_protein INT NOT NULL,
  target_fat INT NOT NULL,
  target_carbs INT NOT NULL,

  -- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ»Ğ°Ğ½Ğ°
  avg_calories INT,
  avg_protein DECIMAL(5,2),
  avg_fat DECIMAL(5,2),
  avg_carbs DECIMAL(5,2),
  unique_recipes INT,                         -- ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ²

  created_at TIMESTAMP DEFAULT NOW(),

  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE INDEX idx_meal_plans_user ON meal_plans(user_id);
CREATE INDEX idx_meal_plans_status ON meal_plans(status);
```

### 6. meal_days (Ğ”Ğ½Ğ¸ Ğ² Ğ¿Ğ»Ğ°Ğ½Ğµ)
```sql
CREATE TABLE meal_days (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  meal_plan_id UUID REFERENCES meal_plans(id) ON DELETE CASCADE,

  week_number INT NOT NULL,                   -- 1-4
  day_number INT NOT NULL,                    -- 1-7 (Ğ¿Ğ½-Ğ²Ñ)

  -- Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ½Ñ
  total_calories INT,
  total_protein DECIMAL(5,2),
  total_fat DECIMAL(5,2),
  total_carbs DECIMAL(5,2),

  UNIQUE (meal_plan_id, week_number, day_number)
);

CREATE INDEX idx_meal_days_plan ON meal_days(meal_plan_id);
```

### 7. meals (ĞŸÑ€Ğ¸Ñ‘Ğ¼Ñ‹ Ğ¿Ğ¸Ñ‰Ğ¸)
```sql
CREATE TABLE meals (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  meal_day_id UUID REFERENCES meal_days(id) ON DELETE CASCADE,
  recipe_id UUID REFERENCES recipes(id),

  meal_type meal_type NOT NULL,               -- breakfast/lunch/dinner/snack
  portion_multiplier DECIMAL(4,2) DEFAULT 1.0,  -- Ğ¼Ğ½Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒ Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ğ¸

  -- Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ ĞšĞ‘Ğ–Ğ£ Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ°
  calories INT,
  protein DECIMAL(5,2),
  fat DECIMAL(5,2),
  carbs DECIMAL(5,2)
);

CREATE INDEX idx_meals_day ON meals(meal_day_id);
CREATE INDEX idx_meals_recipe ON meals(recipe_id);
```

### 8. shopping_list_items (Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº)
```sql
CREATE TABLE shopping_list_items (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  meal_plan_id UUID REFERENCES meal_plans(id) ON DELETE CASCADE,
  product_id UUID REFERENCES products(id),

  total_amount_grams DECIMAL(8,2) NOT NULL,   -- Ğ²ÑĞµĞ³Ğ¾ Ğ½Ğ° Ğ¼ĞµÑÑÑ†
  week_1_amount DECIMAL(8,2),                 -- Ğ½ĞµĞ´ĞµĞ»Ñ 1
  week_2_amount DECIMAL(8,2),                 -- Ğ½ĞµĞ´ĞµĞ»Ñ 2
  week_3_amount DECIMAL(8,2),                 -- Ğ½ĞµĞ´ĞµĞ»Ñ 3
  week_4_amount DECIMAL(8,2),                 -- Ğ½ĞµĞ´ĞµĞ»Ñ 4

  category VARCHAR(50),                       -- Ğ´Ğ»Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ² UI
  is_perishable BOOLEAN,                      -- ÑĞºĞ¾Ñ€Ğ¾Ğ¿Ğ¾Ñ€Ñ‚ÑÑ‰Ğ¸Ğ¹ÑÑ

  FOREIGN KEY (meal_plan_id) REFERENCES meal_plans(id) ON DELETE CASCADE
);

CREATE INDEX idx_shopping_list_plan ON shopping_list_items(meal_plan_id);
```

---

## ğŸ“ TypeScript Ñ‚Ğ¸Ğ¿Ñ‹ (Spec-Driven Development)

### backend/src/types/index.ts

```typescript
// ===== ĞšĞĞ¢Ğ•Ğ“ĞĞ Ğ˜Ğ˜ ĞŸĞ ĞĞ”Ğ£ĞšĞ¢ĞĞ’ =====
export type ProductCategory =
  | 'meat'          // Ğ¼ÑÑĞ¾
  | 'poultry'       // Ğ¿Ñ‚Ğ¸Ñ†Ğ°
  | 'fish'          // Ñ€Ñ‹Ğ±Ğ°
  | 'seafood'       // Ğ¼Ğ¾Ñ€ĞµĞ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹
  | 'dairy'         // Ğ¼Ğ¾Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğµ
  | 'eggs'          // ÑĞ¹Ñ†Ğ°
  | 'grains'        // ĞºÑ€ÑƒĞ¿Ñ‹
  | 'pasta'         // Ğ¼Ğ°ĞºĞ°Ñ€Ğ¾Ğ½Ñ‹
  | 'bread'         // Ñ…Ğ»ĞµĞ±
  | 'vegetables'    // Ğ¾Ğ²Ğ¾Ñ‰Ğ¸
  | 'fruits'        // Ñ„Ñ€ÑƒĞºÑ‚Ñ‹
  | 'nuts'          // Ğ¾Ñ€ĞµÑ…Ğ¸
  | 'dried_fruits'  // ÑÑƒÑ…Ğ¾Ñ„Ñ€ÑƒĞºÑ‚Ñ‹
  | 'oils'          // Ğ¼Ğ°ÑĞ»Ğ°
  | 'condiments'    // ÑĞ¾ÑƒÑÑ‹/Ğ¿Ñ€Ğ¸Ğ¿Ñ€Ğ°Ğ²Ñ‹
  | 'legumes'       // Ğ±Ğ¾Ğ±Ğ¾Ğ²Ñ‹Ğµ
  | 'beverages';    // Ğ½Ğ°Ğ¿Ğ¸Ñ‚ĞºĞ¸

// ===== Ğ¢Ğ˜ĞŸĞ« ĞŸĞ Ğ˜ĞĞœĞĞ’ ĞŸĞ˜Ğ©Ğ˜ =====
export type MealType = 'breakfast' | 'lunch' | 'dinner' | 'snack';

// ===== Ğ¢Ğ˜ĞŸĞ« Ğ¢Ğ•Ğ“ĞĞ’ =====
export type TagType = 'allergen' | 'diet' | 'preference';

// ===== Ğ¡Ğ›ĞĞ–ĞĞĞ¡Ğ¢Ğ¬ Ğ Ğ•Ğ¦Ğ•ĞŸĞ¢Ğ =====
export type RecipeComplexity = 'simple' | 'medium' | 'complex';

// ===== Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡ ĞŸĞ›ĞĞĞ ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ¯ =====
export type MealPlanStatus = 'draft' | 'active' | 'archived';

// ===== ĞŸĞ ĞĞ”Ğ£ĞšĞ¢ =====
export interface Product {
  id: string;
  name: string;
  name_short?: string;

  // ĞšĞ‘Ğ–Ğ£ Ğ½Ğ° 100Ğ³
  calories: number;
  protein: number;
  fat: number;
  carbs: number;
  fiber: number;

  category: ProductCategory;
  is_perishable: boolean;
  cooking_ratio: number;

  is_active: boolean;
  created_at: string;
  updated_at?: string;

  // Relations (ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹)
  tags?: Tag[];
}

// ===== Ğ¢Ğ•Ğ“ =====
export interface Tag {
  id: string;
  name: string;          // lactose, gluten, vegan...
  name_ru: string;       // Ğ›Ğ°ĞºÑ‚Ğ¾Ğ·Ğ°, Ğ“Ğ»ÑÑ‚ĞµĞ½, Ğ’ĞµĞ³Ğ°Ğ½...
  type: TagType;
  description?: string;
  created_at: string;
}

// ===== Ğ˜ĞĞ“Ğ Ğ•Ğ”Ğ˜Ğ•ĞĞ¢ Ğ Ğ•Ğ¦Ğ•ĞŸĞ¢Ğ =====
export interface RecipeItem {
  id: string;
  recipe_id: string;
  product_id: string;
  amount_grams: number;
  is_optional: boolean;
  notes?: string;

  // Relations (ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹)
  product?: Product;
}

// ===== Ğ Ğ•Ğ¦Ğ•ĞŸĞ¢ =====
export interface Recipe {
  id: string;
  name: string;
  name_short?: string;

  meal_type: MealType;
  cooking_time?: number;
  instructions?: string;

  servings: number;
  is_scalable: boolean;
  complexity: RecipeComplexity;

  // ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ĞšĞ‘Ğ–Ğ£ Ğ½Ğ° 1 Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ñ
  cached_calories?: number;
  cached_protein?: number;
  cached_fat?: number;
  cached_carbs?: number;

  is_active: boolean;
  created_at: string;
  updated_at?: string;

  // Relations (ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹)
  items?: RecipeItem[];
  tags?: Tag[];
}

// ===== ĞŸĞ Ğ˜ĞĞœ ĞŸĞ˜Ğ©Ğ˜ =====
export interface Meal {
  id: string;
  meal_day_id: string;
  recipe_id: string;
  meal_type: MealType;
  portion_multiplier: number;

  // Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ ĞšĞ‘Ğ–Ğ£
  calories: number;
  protein: number;
  fat: number;
  carbs: number;

  // Relations (ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹)
  recipe?: Recipe;
}

// ===== Ğ”Ğ•ĞĞ¬ Ğ’ ĞŸĞ›ĞĞĞ• =====
export interface MealDay {
  id: string;
  meal_plan_id: string;
  week_number: number;  // 1-4
  day_number: number;   // 1-7

  // Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ½Ñ
  total_calories: number;
  total_protein: number;
  total_fat: number;
  total_carbs: number;

  // Relations (ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹)
  meals?: Meal[];
}

// ===== ĞŸĞ›ĞĞ ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ¯ =====
export interface MealPlan {
  id: string;
  user_id: string;
  weeks: number;
  status: MealPlanStatus;

  // Ğ¦ĞµĞ»ĞµĞ²Ñ‹Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑÑ‹
  target_calories: number;
  target_protein: number;
  target_fat: number;
  target_carbs: number;

  // Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
  avg_calories?: number;
  avg_protein?: number;
  avg_fat?: number;
  avg_carbs?: number;
  unique_recipes?: number;

  created_at: string;

  // Relations (ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹)
  days?: MealDay[];
  user?: User;
}

// ===== ĞŸĞĞ—Ğ˜Ğ¦Ğ˜Ğ¯ Ğ’ Ğ¡ĞŸĞ˜Ğ¡ĞšĞ• ĞŸĞĞšĞ£ĞŸĞĞš =====
export interface ShoppingListItem {
  id: string;
  meal_plan_id: string;
  product_id: string;

  total_amount_grams: number;
  week_1_amount?: number;
  week_2_amount?: number;
  week_3_amount?: number;
  week_4_amount?: number;

  category: ProductCategory;
  is_perishable: boolean;

  // Relations (ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹)
  product?: Product;
}

// ===== Ğ¡ĞŸĞ˜Ğ¡ĞĞš ĞŸĞĞšĞ£ĞŸĞĞš (Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹) =====
export interface ShoppingList {
  meal_plan_id: string;
  monthly: Array<{
    product: Product;
    amount_grams: number;
    amount_display: string;  // "500 Ğ³" Ğ¸Ğ»Ğ¸ "5 ÑˆÑ‚"
  }>;
  weekly: {
    week_1: Array<{
      product: Product;
      amount_grams: number;
      amount_display: string;
    }>;
    week_2: Array<{ product: Product; amount_grams: number; amount_display: string }>;
    week_3: Array<{ product: Product; amount_grams: number; amount_display: string }>;
    week_4: Array<{ product: Product; amount_grams: number; amount_display: string }>;
  };
}

// ===== Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯ ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ¯ =====
export interface UserExclusions {
  tags: string[];        // ID Ñ‚ĞµĞ³Ğ¾Ğ²
  products: string[];    // ID Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²
}

// ===== Ğ—ĞĞŸĞ ĞĞ¡ ĞĞ Ğ“Ğ•ĞĞ•Ğ ĞĞ¦Ğ˜Ğ® ĞŸĞ›ĞĞĞ =====
export interface GenerateMealPlanRequest {
  user_id: string;
  weeks?: number;                        // Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 4
  allow_repeat_days?: number;            // Ğ½Ğµ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€ÑÑ‚ÑŒ Ñ€ĞµÑ†ĞµĞ¿Ñ‚ N Ğ´Ğ½ĞµĞ¹ Ğ¿Ğ¾Ğ´Ñ€ÑĞ´ (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 3)
  prefer_simple?: boolean;               // Ğ¿Ñ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ‹Ğµ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ñ‹
  exclusions?: UserExclusions;           // Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ (ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ñ‹, Ğ±ĞµÑ€Ñ‘Ğ¼ Ğ¸Ğ· user_excluded_tags/products)
}

// ===== Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢ Ğ“Ğ•ĞĞ•Ğ ĞĞ¦Ğ˜Ğ˜ =====
export interface GenerateMealPlanResponse {
  meal_plan_id: string;
  status: MealPlanStatus;
  summary: {
    avg_calories: number;
    avg_protein: number;
    avg_fat: number;
    avg_carbs: number;
    unique_recipes: number;
    deviation_percent: number;           // Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ Ñ†ĞµĞ»ĞµĞ²Ñ‹Ñ… ĞºĞ°Ğ»Ğ¾Ñ€Ğ¸Ğ¹ (%)
  };
  warnings?: string[];                   // Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ (Ğ½ĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ² Ğ¸ Ñ‚.Ğ´.)
}

// ===== Ğ ĞĞ¡ĞŸĞ Ğ•Ğ”Ğ•Ğ›Ğ•ĞĞ˜Ğ• ĞœĞĞšĞ ĞĞ¡ĞĞ’ ĞŸĞ ĞŸĞ Ğ˜ĞĞœĞĞœ =====
export interface MealDistribution {
  breakfast: { calories: number; protein: number; fat: number; carbs: number };
  lunch: { calories: number; protein: number; fat: number; carbs: number };
  dinner: { calories: number; protein: number; fat: number; carbs: number };
  snack: { calories: number; protein: number; fat: number; carbs: number };
}
```

---

## ğŸ”§ Backend Services (TypeScript)

### 1. backend/src/services/mealPlanGenerator.ts

Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ»Ğ°Ğ½Ğ°:

```typescript
import { query } from '../db/postgres';
import type {
  MealPlan,
  MealDay,
  Meal,
  Recipe,
  User,
  UserExclusions,
  GenerateMealPlanRequest,
  GenerateMealPlanResponse,
  MealDistribution,
  MealType
} from '../types';

/**
 * Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ğµ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑĞ¾Ğ² Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ°Ğ¼ Ğ¿Ğ¸Ñ‰Ğ¸
 */
const MEAL_DISTRIBUTION_RATIOS: Record<MealType, number> = {
  breakfast: 0.25,  // 25%
  lunch: 0.35,      // 35%
  dinner: 0.30,     // 30%
  snack: 0.10       // 10%
};

/**
 * Ğ¡ĞµÑ€Ğ²Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ² Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ
 */
export class MealPlanGenerator {
  /**
   * Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ° Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
   */
  async generate(request: GenerateMealPlanRequest): Promise<GenerateMealPlanResponse> {
    const { user_id, weeks = 4, allow_repeat_days = 3, prefer_simple = true } = request;

    // 1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ¸ ĞµĞ³Ğ¾ Ñ†ĞµĞ»ĞµĞ²Ñ‹Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑÑ‹
    const user = await this.getUserWithMacros(user_id);

    // 2. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
    const exclusions = request.exclusions || await this.getUserExclusions(user_id);

    // 3. Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑĞ¾Ğ² Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ°Ğ¼ Ğ¿Ğ¸Ñ‰Ğ¸
    const mealDistribution = this.distributeMacros({
      calories: user.target_calories,
      protein: user.target_protein,
      fat: user.target_fat,
      carbs: user.target_carbs
    });

    // 4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ¿Ğ»Ğ°Ğ½ Ğ² Ğ‘Ğ”
    const mealPlan = await this.createMealPlan(user, weeks);

    // 5. Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ´Ğ½Ğ¸ Ğ¸ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ñ‹ Ğ¿Ğ¸Ñ‰Ğ¸
    const warnings: string[] = [];
    let totalCalories = 0;
    let totalProtein = 0;
    let totalFat = 0;
    let totalCarbs = 0;
    const usedRecipes = new Set<string>();
    const recentRecipes: string[] = [];  // Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ N Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ diversity check

    for (let week = 1; week <= weeks; week++) {
      for (let day = 1; day <= 7; day++) {
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ´ĞµĞ½ÑŒ
        const mealDay = await this.createMealDay(mealPlan.id, week, day);

        let dayCalories = 0;
        let dayProtein = 0;
        let dayFat = 0;
        let dayCarbs = 0;

        // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ñ‹ Ğ¿Ğ¸Ñ‰Ğ¸
        for (const mealType of ['breakfast', 'lunch', 'dinner', 'snack'] as MealType[]) {
          const target = mealDistribution[mealType];

          // ĞŸĞ¾Ğ´Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ñ€ĞµÑ†ĞµĞ¿Ñ‚
          const recipe = await this.selectRecipe({
            mealType,
            target,
            exclusions,
            recentRecipes: recentRecipes.slice(-allow_repeat_days),
            preferSimple: prefer_simple
          });

          if (!recipe) {
            warnings.push(`ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ñ€ĞµÑ†ĞµĞ¿Ñ‚ Ğ´Ğ»Ñ ${mealType} (Ğ½ĞµĞ´ĞµĞ»Ñ ${week}, Ğ´ĞµĞ½ÑŒ ${day})`);
            continue;
          }

          // ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ñ
          const portionMultiplier = this.optimizePortion(recipe, target);

          // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼ Ğ¿Ğ¸Ñ‰Ğ¸
          const meal = await this.createMeal({
            meal_day_id: mealDay.id,
            recipe_id: recipe.id,
            meal_type: mealType,
            portion_multiplier: portionMultiplier
          });

          dayCalories += meal.calories;
          dayProtein += meal.protein;
          dayFat += meal.fat;
          dayCarbs += meal.carbs;

          usedRecipes.add(recipe.id);
          recentRecipes.push(recipe.id);
        }

        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ¸Ñ‚Ğ¾Ğ³Ğ¸ Ğ´Ğ½Ñ
        await this.updateMealDayTotals(mealDay.id, {
          total_calories: dayCalories,
          total_protein: dayProtein,
          total_fat: dayFat,
          total_carbs: dayCarbs
        });

        totalCalories += dayCalories;
        totalProtein += dayProtein;
        totalFat += dayFat;
        totalCarbs += dayCarbs;
      }
    }

    // 6. ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ¿Ğ»Ğ°Ğ½Ğ°
    const totalDays = weeks * 7;
    await this.updateMealPlanStats(mealPlan.id, {
      avg_calories: Math.round(totalCalories / totalDays),
      avg_protein: Math.round(totalProtein / totalDays),
      avg_fat: Math.round(totalFat / totalDays),
      avg_carbs: Math.round(totalCarbs / totalDays),
      unique_recipes: usedRecipes.size,
      status: 'active'
    });

    // 7. Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº
    await this.generateShoppingList(mealPlan.id, weeks);

    // 8. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
    const avgCalories = Math.round(totalCalories / totalDays);
    const deviation = Math.abs((avgCalories - user.target_calories) / user.target_calories * 100);

    return {
      meal_plan_id: mealPlan.id,
      status: 'active',
      summary: {
        avg_calories: avgCalories,
        avg_protein: Math.round(totalProtein / totalDays),
        avg_fat: Math.round(totalFat / totalDays),
        avg_carbs: Math.round(totalCarbs / totalDays),
        unique_recipes: usedRecipes.size,
        deviation_percent: Math.round(deviation * 10) / 10
      },
      warnings: warnings.length > 0 ? warnings : undefined
    };
  }

  /**
   * Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑĞ¾Ğ² Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ°Ğ¼ Ğ¿Ğ¸Ñ‰Ğ¸
   */
  private distributeMacros(target: {
    calories: number;
    protein: number;
    fat: number;
    carbs: number;
  }): MealDistribution {
    const distribution: MealDistribution = {} as any;

    for (const [mealType, ratio] of Object.entries(MEAL_DISTRIBUTION_RATIOS)) {
      distribution[mealType as MealType] = {
        calories: Math.round(target.calories * ratio),
        protein: Math.round(target.protein * ratio),
        fat: Math.round(target.fat * ratio),
        carbs: Math.round(target.carbs * ratio)
      };
    }

    return distribution;
  }

  /**
   * ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ° Ğ¿Ğ¾Ğ´ Ñ†ĞµĞ»ĞµĞ²Ñ‹Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑÑ‹
   */
  private async selectRecipe(params: {
    mealType: MealType;
    target: { calories: number; protein: number; fat: number; carbs: number };
    exclusions: UserExclusions;
    recentRecipes: string[];
    preferSimple: boolean;
  }): Promise<Recipe | null> {
    // SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ¿Ğ¾:
    // - Ñ‚Ğ¸Ğ¿Ñƒ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ° Ğ¿Ğ¸Ñ‰Ğ¸
    // - Ğ¸ÑĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ğ¼ Ñ‚ĞµĞ³Ğ°Ğ¼
    // - Ğ¸ÑĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ğ¼ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°Ğ¼ (Ñ‡ĞµÑ€ĞµĞ· recipe_items)
    // - Ğ½ĞµĞ´Ğ°Ğ²Ğ½Ğ¸Ğ¼ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ°Ğ¼ (diversity)
    // Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ğ±Ğ»Ğ¸Ğ·Ğ¾ÑÑ‚Ğ¸ Ğº Ñ†ĞµĞ»ĞµĞ²Ñ‹Ğ¼ Ğ¼Ğ°ĞºÑ€Ğ¾ÑĞ°Ğ¼

    // ĞŸÑĞµĞ²Ğ´Ğ¾ĞºĞ¾Ğ´ (Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ SQL Ğ±ÑƒĞ´ĞµÑ‚ ÑĞ»Ğ¾Ğ¶Ğ½ĞµĞµ):
    const result = await query<Recipe>(`
      SELECT r.*,
        -- Ğ Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ´Ğ¾ Ñ†ĞµĞ»ĞµĞ²Ñ‹Ñ… Ğ¼Ğ°ĞºÑ€Ğ¾ÑĞ¾Ğ² (ÑƒĞ¿Ñ€Ğ¾Ñ‰Ñ‘Ğ½Ğ½Ğ°Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ°)
        ABS(r.cached_calories - $1) +
        ABS(r.cached_protein - $2) * 4 +  -- Ğ±ĞµĞ»Ğ¾Ğº Ğ²Ğ°Ğ¶Ğ½ĞµĞµ
        ABS(r.cached_carbs - $3) as distance
      FROM recipes r
      WHERE r.meal_type = $4
        AND r.is_active = true
        AND r.id NOT IN (SELECT UNNEST($5::uuid[]))  -- recent recipes
        AND NOT EXISTS (
          SELECT 1 FROM recipe_tags rt
          WHERE rt.recipe_id = r.id AND rt.tag_id = ANY($6::uuid[])
        )
        AND NOT EXISTS (
          SELECT 1 FROM recipe_items ri
          WHERE ri.recipe_id = r.id AND ri.product_id = ANY($7::uuid[])
        )
      ORDER BY
        ${params.preferSimple ? 'r.complexity ASC,' : ''}
        distance ASC
      LIMIT 10
    `, [
      params.target.calories,
      params.target.protein,
      params.target.carbs,
      params.mealType,
      params.recentRecipes,
      params.exclusions.tags,
      params.exclusions.products
    ]);

    // Ğ¡Ğ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¸Ğ· Ñ‚Ğ¾Ğ¿-10 Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ½Ğ¾Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¸Ñ
    if (result.rows.length === 0) return null;
    const randomIndex = Math.floor(Math.random() * Math.min(3, result.rows.length));
    return result.rows[randomIndex];
  }

  /**
   * ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ğ¸
   */
  private optimizePortion(
    recipe: Recipe,
    target: { calories: number; protein: number; fat: number; carbs: number }
  ): number {
    // ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ Ğ±ĞµĞ»ĞºÑƒ (Ğ²Ğ°Ğ¶Ğ½ĞµĞµ Ğ²ÑĞµĞ³Ğ¾)
    const multiplier = target.protein / (recipe.cached_protein || 1);

    // ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ€Ğ°Ğ·ÑƒĞ¼Ğ½Ñ‹Ğ¼ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ¾Ğ¼ (0.5x - 2.0x)
    return Math.max(0.5, Math.min(2.0, multiplier));
  }

  // ... Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ‘Ğ”
}
```

---

## ğŸ¨ Frontend Components

### 1. frontend/src/pages/MealPlanPage.tsx

Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ¿Ğ»Ğ°Ğ½Ğ° Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ:

```tsx
import { useState, useEffect } from 'react';
import { useStore } from '../store';
import { api } from '../services/api';
import type { MealPlan, MealDay } from '../types';

/**
 * Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ¿Ğ»Ğ°Ğ½Ğ° Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ
 *
 * Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ:
 * - ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
 * - Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° 7 Ğ´Ğ½ĞµĞ¹ Ã— 4 Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ° Ğ¿Ğ¸Ñ‰Ğ¸
 * - ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ½ĞµĞ´ĞµĞ»ÑĞ¼Ğ¸ (W_01, W_02, W_03, W_04)
 * - ĞšĞ»Ğ¸Ğº Ğ½Ğ° Ğ±Ğ»ÑĞ´Ğ¾ â†’ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ¼
 * - ĞšĞ½Ğ¾Ğ¿ĞºĞ° "Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½" (Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ)
 * - ĞšĞ½Ğ¾Ğ¿ĞºĞ° "Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº"
 * - ĞŸĞ¾ĞºĞ°Ğ· ĞšĞ‘Ğ–Ğ£ Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ² Ğ´Ğ½Ñ
 * - Brutal cyberpunk ÑÑ‚Ğ¸Ğ»ÑŒ
 */

const MealPlanPage = () => {
  const user = useStore((state) => state.user);
  const [mealPlan, setMealPlan] = useState<MealPlan | null>(null);
  const [selectedWeek, setSelectedWeek] = useState(1);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    if (!user?.id) return;

    const loadMealPlan = async () => {
      try {
        setLoading(true);
        const plan = await api.getActiveMealPlan(user.id);
        setMealPlan(plan);
      } catch (err) {
        setError(err instanceof Error ? err.message : 'ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ½Ğ°');
      } finally {
        setLoading(false);
      }
    };

    loadMealPlan();
  }, [user?.id]);

  if (loading) return <LoadingScreen />;

  if (!mealPlan) {
    return (
      <div className="min-h-screen bg-void p-4">
        <div className="brutal-card p-6 text-center">
          <div className="text-4xl mb-4">ğŸ½</div>
          <h2 className="font-display font-bold text-steel-100 text-xl mb-2">
            ĞĞ•Ğ¢_ĞŸĞ›ĞĞĞ_ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ¯
          </h2>
          <p className="font-mono text-sm text-steel-500 mb-6">
            Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ Ğ½Ğ° 4 Ğ½ĞµĞ´ĞµĞ»Ğ¸
          </p>
          <button
            onClick={() => handleGeneratePlan()}
            className="brutal-button w-full"
          >
            <span className="font-mono text-sm">Ğ¡Ğ“Ğ•ĞĞ•Ğ Ğ˜Ğ ĞĞ’ĞĞ¢Ğ¬_ĞŸĞ›ĞĞ</span>
          </button>
        </div>
      </div>
    );
  }

  // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµĞ¼ Ğ´Ğ½Ğ¸ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ½ĞµĞ´ĞµĞ»Ğ¸
  const weekDays = mealPlan.days?.filter(d => d.week_number === selectedWeek) || [];

  return (
    <div className="min-h-screen bg-void p-4">
      {/* Header */}
      <div className="brutal-card p-4 mb-4">
        <div className="flex items-center justify-between">
          <div>
            <h1 className="font-display font-bold text-steel-100 text-xl">
              ĞŸĞ›ĞĞ_ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ¯
            </h1>
            <p className="font-mono text-xs text-steel-500">
              Ğ¦ĞµĞ»ÑŒ: {mealPlan.target_calories} ĞºĞºĞ°Ğ» / Ğ´ĞµĞ½ÑŒ
            </p>
          </div>
          <button
            onClick={() => navigate('/meal-plan/shopping-list')}
            className="brutal-button-sm"
          >
            <span className="text-lg">ğŸ›’</span>
          </button>
        </div>
      </div>

      {/* Week Selector */}
      <div className="flex gap-2 mb-4 overflow-x-auto">
        {[1, 2, 3, 4].map(week => (
          <button
            key={week}
            onClick={() => setSelectedWeek(week)}
            className={`brutal-button-sm flex-shrink-0 ${
              selectedWeek === week ? 'border-neon-lime text-neon-lime' : ''
            }`}
          >
            W_{String(week).padStart(2, '0')}
          </button>
        ))}
      </div>

      {/* Meal Table */}
      <div className="space-y-2">
        {weekDays.map(day => (
          <DayCard key={day.id} day={day} />
        ))}
      </div>

      {/* Actions */}
      <div className="mt-6 brutal-card p-4">
        <button
          onClick={() => handleRegenerate()}
          className="brutal-button w-full mb-2"
        >
          Ğ¡Ğ“Ğ•ĞĞ•Ğ Ğ˜Ğ ĞĞ’ĞĞ¢Ğ¬_Ğ—ĞĞĞĞ’Ğ
        </button>
        <p className="font-mono text-xs text-steel-500 text-center">
          Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ±ÑƒĞ´ĞµÑ‚ Ğ·Ğ°Ğ¼ĞµĞ½Ñ‘Ğ½
        </p>
      </div>
    </div>
  );
};
```

### 2. frontend/src/components/RecipeModal.tsx

ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ¼:

```tsx
/**
 * ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ°
 *
 * ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚:
 * - ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ±Ğ»ÑĞ´Ğ°
 * - ĞšĞ‘Ğ–Ğ£ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ñ
 * - Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¸Ğ½Ğ³Ñ€ĞµĞ´Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ñ Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¾Ğ²ĞºĞ¾Ğ¹
 * - Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ
 * - Ğ’Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ
 */
```

### 3. frontend/src/pages/ShoppingListPage.tsx

Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº:

```tsx
/**
 * Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº
 *
 * Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°:
 * - ĞĞ° Ğ¼ĞµÑÑÑ† (Ğ½ĞµÑĞºĞ¾Ñ€Ğ¾Ğ¿Ğ¾Ñ€Ñ‚ÑÑ‰Ğ¸ĞµÑÑ)
 * - ĞĞµĞ´ĞµĞ»Ñ 1 (ÑĞºĞ¾Ñ€Ğ¾Ğ¿Ğ¾Ñ€Ñ‚ÑÑ‰Ğ¸ĞµÑÑ)
 * - ĞĞµĞ´ĞµĞ»Ñ 2
 * - ĞĞµĞ´ĞµĞ»Ñ 3
 * - ĞĞµĞ´ĞµĞ»Ñ 4
 *
 * ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸:
 * - ĞœÑÑĞ¾/ĞŸÑ‚Ğ¸Ñ†Ğ°
 * - Ğ Ñ‹Ğ±Ğ°
 * - ĞœĞ¾Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğµ
 * - ĞšÑ€ÑƒĞ¿Ñ‹
 * - ĞĞ²Ğ¾Ñ‰Ğ¸
 * - Ğ¤Ñ€ÑƒĞºÑ‚Ñ‹
 * - ĞŸÑ€Ğ¾Ñ‡ĞµĞµ
 */
```

---

## ğŸš€ ĞŸĞ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### Phase 1: Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ Ñ‚Ğ¸Ğ¿Ñ‹ (2-3 Ğ´Ğ½Ñ)
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ 014_nutrition_schema.sql
- [ ] Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ² backend/src/types/index.ts
- [ ] Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ² frontend/src/types/index.ts
- [ ] Seed Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ñ‹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² (50-100 Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²)
- [ ] Seed Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ñ… Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ¾Ğ² (20-30 Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ‚Ğ¸Ğ¿ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ°)

### Phase 2: Backend Services (3-4 Ğ´Ğ½Ñ)
- [ ] MealPlanGenerator service
- [ ] MacroDistributor helper
- [ ] RecipeSelector Ñ SQL Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹
- [ ] PortionOptimizer helper
- [ ] ShoppingListGenerator service
- [ ] API endpoints (/api/nutrition/*)

### Phase 3: Frontend Components (3-4 Ğ´Ğ½Ñ)
- [ ] MealPlanPage.tsx
- [ ] DayCard.tsx component
- [ ] MealCard.tsx component
- [ ] RecipeModal.tsx
- [ ] ShoppingListPage.tsx
- [ ] ExclusionsModal.tsx (Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ°Ğ»Ğ»ĞµÑ€Ğ³Ğ¸Ğ¹/Ğ´Ğ¸ĞµÑ‚)
- [ ] Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² Layout.tsx (Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ± ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ•)

### Phase 4: Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ (2 Ğ´Ğ½Ñ)
- [ ] Ğ¡Ğ²ÑĞ·Ğ°Ñ‚ÑŒ Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¼ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ¾Ğ¼ ĞšĞ‘Ğ–Ğ£
- [ ] ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑÑ‚ÑŒ ĞšĞ‘Ğ–Ğ£ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ²ĞµÑĞ°
- [ ] Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ² Telegram Ğ¿Ñ€Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ»Ğ°Ğ½Ğ°
- [ ] ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ° Ñ‚Ñ€ĞµĞ½ĞµÑ€Ğ° (Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ² ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²)

### Phase 5: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ (2 Ğ´Ğ½Ñ)
- [ ] Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ»Ğ°Ğ½Ğ¾Ğ²
- [ ] Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº
- [ ] ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- [ ] Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ½Ğ° Railway
- [ ] Smoke testing

**Ğ˜Ñ‚Ğ¾Ğ³Ğ¾:** ~12-15 Ğ´Ğ½ĞµĞ¹

---

## ğŸ¯ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ñ Ğ¾Ñ‚ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ°

1. **Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ User Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Client**
   - Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ users
   - Ğ¦ĞµĞ»ĞµĞ²Ñ‹Ğµ Ğ¼Ğ°ĞºÑ€Ğ¾ÑÑ‹ Ğ±ĞµÑ€ÑƒÑ‚ÑÑ Ğ¸Ğ· Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ° ĞšĞ‘Ğ–Ğ£

2. **ĞĞ´Ğ°Ğ¿Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ´ Ñ†ĞµĞ»Ğ¸ ĞºÑƒÑ€ÑĞ°**
   - weight_loss â†’ Ğ´ĞµÑ„Ğ¸Ñ†Ğ¸Ñ‚ ĞºĞ°Ğ»Ğ¾Ñ€Ğ¸Ğ¹ (Ğ²ĞµÑ Ã— 30)
   - muscle_gain â†’ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ñ†Ğ¸Ñ‚ ĞºĞ°Ğ»Ğ¾Ñ€Ğ¸Ğ¹ (Ğ²ĞµÑ Ã— 32)

3. **ĞšÑƒÑ€Ñ Ğ½Ğ° 16 Ğ½ĞµĞ´ĞµĞ»ÑŒ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾**
   - ĞŸĞ»Ğ°Ğ½Ñ‹ Ğ½Ğ° 4 Ğ½ĞµĞ´ĞµĞ»Ğ¸ (1 Ğ¼ĞµÑÑÑ†)
   - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ·Ğ°Ğ¼ĞµÑ€Ğ°Ñ… Ğ²ĞµÑĞ°

4. **Brutal cyberpunk Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½**
   - Dark void background (#0f172a, #1e293b)
   - Neon colors (lime, cyan, magenta)
   - Mono fonts (font-mono)
   - Brutal cards with borders

5. **ĞĞµÑ‚ PDF ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ°**
   - Ğ’ÑÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ² Mini App
   - ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¶Ğµ ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ

6. **Telegram Ğ±Ğ¾Ñ‚ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ**
   - Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¿Ğ»Ğ°Ğ½Ğ°
   - ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ /meal_plan, /shopping_list Ğ² Ğ±Ğ¾Ñ‚Ğµ

---

## ğŸ“Š SQL Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ (Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)

### ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹:
```sql
-- ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹
CREATE INDEX idx_products_category ON products(category);
CREATE INDEX idx_products_active ON products(is_active) WHERE is_active = true;

-- Ğ ĞµÑ†ĞµĞ¿Ñ‚Ñ‹
CREATE INDEX idx_recipes_meal_type ON recipes(meal_type);
CREATE INDEX idx_recipes_active ON recipes(is_active) WHERE is_active = true;
CREATE INDEX idx_recipe_items_recipe ON recipe_items(recipe_id);

-- ĞŸĞ»Ğ°Ğ½Ñ‹
CREATE INDEX idx_meal_plans_user ON meal_plans(user_id);
CREATE INDEX idx_meal_plans_status ON meal_plans(status);
CREATE INDEX idx_meal_days_plan ON meal_days(meal_plan_id);
CREATE INDEX idx_meals_day ON meals(meal_day_id);

-- Ğ¢ĞµĞ³Ğ¸
CREATE INDEX idx_product_tags_tag ON product_tags(tag_id);
CREATE INDEX idx_recipe_tags_tag ON recipe_tags(tag_id);
```

---

## ğŸ” ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ñ‡ĞµÑ€ĞµĞ· FatSecret API

### **Flow Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ**

#### **1. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹**

```tsx
// ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ»Ğ°Ğ½ Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ_ĞŸĞ›ĞĞĞ_ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ¯                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ Ğ¦ĞµĞ»ĞµĞ²Ñ‹Ğµ ĞºĞ°Ğ»Ğ¾Ñ€Ğ¸Ğ¸: 2100 ĞºĞºĞ°Ğ»/Ğ´ĞµĞ½ÑŒ                             â”‚
â”‚ (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¸Ğ· Ğ²ĞµÑĞ° Ğ¸ Ñ†ĞµĞ»Ğ¸)                              â”‚
â”‚                                                             â”‚
â”‚ â˜‘ Ğ£ Ğ¼ĞµĞ½Ñ ĞµÑÑ‚ÑŒ Ğ°Ğ»Ğ»ĞµÑ€Ğ³Ğ¸Ğ¸/Ğ´Ğ¸ĞµÑ‚Ñ‹                                â”‚
â”‚   Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾: ğŸ¥› Ğ›Ğ°ĞºÑ‚Ğ¾Ğ·Ğ°, ğŸŒ¾ Ğ“Ğ»ÑÑ‚ĞµĞ½                            â”‚
â”‚                                                             â”‚
â”‚ â˜‘ Ğ˜ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ [ğŸ” ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ Ğ´Ğ»Ñ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ...        ] [ĞŸĞ¾Ğ¸ÑĞº]  â”‚ â”‚
â”‚   â”‚                                                       â”‚ â”‚
â”‚   â”‚ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ FatSecret:                                 â”‚ â”‚
â”‚   â”‚ â€¢ ĞšÑƒÑ€Ğ¸Ğ½Ğ°Ñ Ğ³Ñ€ÑƒĞ´ĞºĞ° (165 ĞºĞºĞ°Ğ», Ğ‘:31Ğ³)  [+ Ğ˜ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ]    â”‚ â”‚
â”‚   â”‚ â€¢ Ğ“Ñ€ĞµÑ‡ĞºĞ° (123 ĞºĞºĞ°Ğ», Ğ‘:4.5Ğ³, Ğ£:25Ğ³)  [+ Ğ˜ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ]    â”‚ â”‚
â”‚   â”‚ â€¢ Ğ‘Ñ€Ğ¾ĞºĞºĞ¾Ğ»Ğ¸ (34 ĞºĞºĞ°Ğ», Ğ‘:2.8Ğ³)        [+ Ğ˜ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ]    â”‚ â”‚
â”‚   â”‚                                                       â”‚ â”‚
â”‚   â”‚ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¾:                                            â”‚ â”‚
â”‚   â”‚ â€¢ âŒ ĞœĞ¾Ğ»Ğ¾ĞºĞ¾                                            â”‚ â”‚
â”‚   â”‚ â€¢ âŒ Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³                                            â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ [Ğ¡Ğ“Ğ•ĞĞ•Ğ Ğ˜Ğ ĞĞ’ĞĞ¢Ğ¬_ĞŸĞ›ĞĞ]  [ĞĞ¢ĞœĞ•ĞĞ]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **2. ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¸ Ğ·Ğ°Ğ¼ĞµĞ½Ğ° Ğ¸Ğ½Ğ³Ñ€ĞµĞ´Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğµ**

```tsx
// ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ĞºĞ»Ğ¸ĞºĞ°ĞµÑ‚ Ğ½Ğ° Ğ±Ğ»ÑĞ´Ğ¾ Ğ² Ğ¿Ğ»Ğ°Ğ½Ğµ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ Ğ•Ğ¦Ğ•ĞŸĞ¢: ĞĞ¼Ğ»ĞµÑ‚ Ñ Ğ¾Ğ²Ğ¾Ñ‰Ğ°Ğ¼Ğ¸                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ ĞšĞ‘Ğ–Ğ£: 320 ĞºĞºĞ°Ğ» | Ğ‘: 22Ğ³ | Ğ–: 18Ğ³ | Ğ£: 15Ğ³                  â”‚
â”‚                                                             â”‚
â”‚ Ğ˜Ğ½Ğ³Ñ€ĞµĞ´Ğ¸ĞµĞ½Ñ‚Ñ‹:                                                â”‚
â”‚ â€¢ Ğ¯Ğ¹Ñ†Ğ° ĞºÑƒÑ€Ğ¸Ğ½Ñ‹Ğµ - 3 ÑˆÑ‚ (150Ğ³)                                â”‚
â”‚   [ğŸ” ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ·Ğ°Ğ¼ĞµĞ½Ñƒ]                                         â”‚
â”‚                                                             â”‚
â”‚ â€¢ ĞœĞ¾Ğ»Ğ¾ĞºĞ¾ - 50Ğ¼Ğ»                                             â”‚
â”‚   [ğŸ” ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ·Ğ°Ğ¼ĞµĞ½Ñƒ]  â† ĞšĞ»Ğ¸Ğº                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ĞŸĞ¾Ğ¸ÑĞº Ğ·Ğ°Ğ¼ĞµĞ½Ñ‹ Ğ´Ğ»Ñ "ĞœĞ¾Ğ»Ğ¾ĞºĞ¾":                          â”‚   â”‚
â”‚   â”‚ [ğŸ” Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚...              ] [ĞŸĞ¾Ğ¸ÑĞº]       â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚ â€¢ ĞœĞ¸Ğ½Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾ (15 ĞºĞºĞ°Ğ»)  [âœ“ Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ]        â”‚   â”‚
â”‚   â”‚ â€¢ ĞšĞ¾ĞºĞ¾ÑĞ¾Ğ²Ğ¾Ğµ Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾ (230 ĞºĞºĞ°Ğ»)  [âœ“ Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ]        â”‚   â”‚
â”‚   â”‚ â€¢ Ğ¡Ğ¾ĞµĞ²Ğ¾Ğµ Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾ (54 ĞºĞºĞ°Ğ»)      [âœ“ Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ]        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚ â€¢ ĞŸĞ¾Ğ¼Ğ¸Ğ´Ğ¾Ñ€Ñ‹ - 100Ğ³                                           â”‚
â”‚ â€¢ Ğ¨Ğ¿Ğ¸Ğ½Ğ°Ñ‚ - 50Ğ³                                              â”‚
â”‚                                                             â”‚
â”‚ ĞŸÑ€Ğ¸Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:                                              â”‚
â”‚ 1. Ğ’Ğ·Ğ±Ğ¸Ñ‚ÑŒ ÑĞ¹Ñ†Ğ° Ñ Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾Ğ¼...                                 â”‚
â”‚                                                             â”‚
â”‚ [Ğ¡ĞĞ¥Ğ ĞĞĞ˜Ğ¢Ğ¬_Ğ˜Ğ—ĞœĞ•ĞĞ•ĞĞ˜Ğ¯]  [ĞĞ¢ĞœĞ•ĞĞ˜Ğ¢Ğ¬_Ğ Ğ•Ğ¦Ğ•ĞŸĞ¢]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Backend API Endpoints**

```typescript
// ===== ĞŸĞĞ˜Ğ¡Ğš ĞŸĞ ĞĞ”Ğ£ĞšĞ¢ĞĞ’ =====

/**
 * ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ñ‡ĞµÑ€ĞµĞ· FatSecret API
 * 1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½ÑƒÑ Ğ‘Ğ” (ĞºÑÑˆ)
 * 2. Ğ•ÑĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ â†’ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğº FatSecret
 * 3. ĞšÑÑˆĞ¸Ñ€ÑƒĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
 */
GET /api/nutrition/products/search
Query: {
  q: string;            // Ğ¿Ğ¾Ğ¸ÑĞºĞ¾Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
  limit?: number;       // Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 20
  source?: 'local' | 'fatsecret' | 'all';  // Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº Ğ¿Ğ¾Ğ¸ÑĞºĞ°
}

Response: {
  products: Array<{
    id?: string;                    // ĞµÑĞ»Ğ¸ Ğ¸Ğ· Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ‘Ğ”
    fatsecret_id?: string;          // ĞµÑĞ»Ğ¸ Ğ¸Ğ· FatSecret
    name: string;
    calories: number;
    protein: number;
    fat: number;
    carbs: number;
    fiber?: number;
    source: 'local' | 'fatsecret';  // Ğ¾Ñ‚ĞºÑƒĞ´Ğ° Ğ²Ğ·ÑÑ‚
  }>;
  total: number;
  cached: boolean;                  // Ğ¸Ğ· ĞºÑÑˆĞ° Ğ¸Ğ»Ğ¸ live Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
}

/**
 * Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ Ğ¸Ğ· FatSecret Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½ÑƒÑ Ğ‘Ğ”
 * Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼
 */
POST /api/nutrition/products/import
Body: {
  fatsecret_id: string;
  user_id: string;  // ĞºÑ‚Ğ¾ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ (Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸)
}

Response: {
  product_id: string;  // ID Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ‘Ğ”
  imported: boolean;
  already_exists: boolean;
}

/**
 * Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ Ğ² Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
 */
POST /api/nutrition/exclusions/:userId/products
Body: {
  product_id?: string;           // Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ID
  fatsecret_id?: string;         // Ğ¸Ğ»Ğ¸ FatSecret ID (Ğ°Ğ²Ñ‚Ğ¾Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚)
  product_name: string;
}

Response: {
  exclusion_id: string;
  product_id: string;  // Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ±Ñ‹Ğ»Ğ¾
}
```

### **Frontend Components**

#### **ProductSearchModal.tsx**

```typescript
import { useState, useEffect } from 'react';
import { api } from '../services/api';
import type { Product } from '../types';

interface ProductSearchModalProps {
  isOpen: boolean;
  onClose: () => void;
  onSelect: (product: Product) => void;
  mode: 'exclude' | 'replace';  // Ğ¸ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ·Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ
  title?: string;
}

const ProductSearchModal = ({
  isOpen,
  onClose,
  onSelect,
  mode,
  title = 'ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²'
}: ProductSearchModalProps) => {
  const [query, setQuery] = useState('');
  const [results, setResults] = useState<Product[]>([]);
  const [loading, setLoading] = useState(false);
  const [source, setSource] = useState<'all' | 'local' | 'fatsecret'>('all');

  const handleSearch = async () => {
    if (query.length < 2) return;

    setLoading(true);
    try {
      const data = await api.searchProducts(query, source);
      setResults(data.products);
    } catch (err) {
      console.error('Search failed:', err);
    } finally {
      setLoading(false);
    }
  };

  const handleSelect = async (product: Product) => {
    // Ğ•ÑĞ»Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ Ğ¸Ğ· FatSecret, Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² Ğ‘Ğ”
    if (product.source === 'fatsecret' && product.fatsecret_id) {
      const imported = await api.importProduct(product.fatsecret_id);
      product.id = imported.product_id;
    }

    onSelect(product);
    onClose();
  };

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 bg-void/90 backdrop-blur-sm flex items-center justify-center p-4 z-50">
      <div className="brutal-card max-w-2xl w-full max-h-[80vh] overflow-y-auto">
        {/* Header */}
        <div className="p-4 border-b-2 border-void-400">
          <h2 className="font-display font-bold text-steel-100 text-xl uppercase">
            {title}
          </h2>
        </div>

        {/* Search Bar */}
        <div className="p-4 border-b border-void-400">
          <div className="flex gap-2">
            <input
              type="text"
              value={query}
              onChange={(e) => setQuery(e.target.value)}
              onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
              placeholder="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°..."
              className="flex-1 bg-void-300 border-2 border-steel-600 text-steel-100
                         px-4 py-2 font-mono text-sm focus:border-neon-lime outline-none"
            />
            <button
              onClick={handleSearch}
              disabled={loading}
              className="brutal-button px-6"
            >
              {loading ? 'ĞŸĞĞ˜Ğ¡Ğš...' : 'ğŸ” ĞŸĞĞ˜Ğ¡Ğš'}
            </button>
          </div>

          {/* Source Filter */}
          <div className="flex gap-2 mt-3">
            <button
              onClick={() => setSource('all')}
              className={`font-mono text-xs px-3 py-1 border ${
                source === 'all'
                  ? 'border-neon-lime text-neon-lime'
                  : 'border-steel-600 text-steel-500'
              }`}
            >
              Ğ’Ğ¡Ğ•
            </button>
            <button
              onClick={() => setSource('local')}
              className={`font-mono text-xs px-3 py-1 border ${
                source === 'local'
                  ? 'border-neon-lime text-neon-lime'
                  : 'border-steel-600 text-steel-500'
              }`}
            >
              Ğ›ĞĞšĞĞ›Ğ¬ĞĞĞ¯_Ğ‘Ğ”
            </button>
            <button
              onClick={() => setSource('fatsecret')}
              className={`font-mono text-xs px-3 py-1 border ${
                source === 'fatsecret'
                  ? 'border-neon-lime text-neon-lime'
                  : 'border-steel-600 text-steel-500'
              }`}
            >
              FATSECRET
            </button>
          </div>
        </div>

        {/* Results */}
        <div className="p-4 space-y-2">
          {results.length === 0 && !loading && (
            <p className="font-mono text-sm text-steel-500 text-center py-8">
              Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²
            </p>
          )}

          {results.map((product, index) => (
            <div
              key={product.id || product.fatsecret_id || index}
              className="bg-void-300 border border-void-400 p-3 hover:border-neon-lime transition-colors"
            >
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <div className="flex items-center gap-2">
                    <h3 className="font-mono text-sm font-bold text-steel-100">
                      {product.name}
                    </h3>
                    <span className={`font-mono text-xs px-2 py-0.5 ${
                      product.source === 'local'
                        ? 'bg-neon-lime/20 text-neon-lime'
                        : 'bg-neon-cyan/20 text-neon-cyan'
                    }`}>
                      {product.source === 'local' ? 'Ğ‘Ğ”' : 'API'}
                    </span>
                  </div>
                  <p className="font-mono text-xs text-steel-400 mt-1">
                    {product.calories} ĞºĞºĞ°Ğ» |
                    Ğ‘: {product.protein}Ğ³ |
                    Ğ–: {product.fat}Ğ³ |
                    Ğ£: {product.carbs}Ğ³
                  </p>
                </div>
                <button
                  onClick={() => handleSelect(product)}
                  className="brutal-button-sm ml-4"
                >
                  {mode === 'exclude' ? '+ Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ˜Ğ¢Ğ¬' : 'âœ“ Ğ—ĞĞœĞ•ĞĞ˜Ğ¢Ğ¬'}
                </button>
              </div>
            </div>
          ))}
        </div>

        {/* Footer */}
        <div className="p-4 border-t-2 border-void-400">
          <button onClick={onClose} className="brutal-button w-full">
            Ğ—ĞĞšĞ Ğ«Ğ¢Ğ¬
          </button>
        </div>
      </div>
    </div>
  );
};

export default ProductSearchModal;
```

### **Backend Service: NutritionDataService**

```typescript
// backend/src/services/nutritionDataService.ts

import axios from 'axios';
import { query } from '../db/postgres';
import type { Product } from '../types';

interface FatSecretProduct {
  food_id: string;
  food_name: string;
  food_description: string;  // "Per 100g - Calories: 165kcal | Fat: 3.6g | Carbs: 0g | Protein: 31g"
}

export class NutritionDataService {
  private clientId: string;
  private clientSecret: string;
  private accessToken?: string;
  private tokenExpiry?: Date;
  private readonly baseUrl = 'https://platform.fatsecret.com/rest';
  private readonly tokenUrl = 'https://oauth.fatsecret.com/connect/token';

  constructor(clientId: string, clientSecret: string) {
    this.clientId = clientId;
    this.clientSecret = clientSecret;
  }

  /**
   * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ OAuth 2.0 Ñ‚Ğ¾ĞºĞµĞ½
   */
  private async getAccessToken(): Promise<string> {
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ‚Ğ¾ĞºĞµĞ½
    if (this.accessToken && this.tokenExpiry && new Date() < this.tokenExpiry) {
      return this.accessToken;
    }

    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ‚Ğ¾ĞºĞµĞ½
    const response = await axios.post(
      this.tokenUrl,
      new URLSearchParams({
        grant_type: 'client_credentials',
        client_id: this.clientId,
        client_secret: this.clientSecret,
        scope: 'basic'
      }),
      {
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        }
      }
    );

    this.accessToken = response.data.access_token;
    this.tokenExpiry = new Date(Date.now() + (response.data.expires_in - 60) * 1000);

    return this.accessToken;
  }

  /**
   * ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ğ² FatSecret API
   */
  async searchFatSecret(searchQuery: string, maxResults: number = 20): Promise<FatSecretProduct[]> {
    const token = await this.getAccessToken();

    const response = await axios.get(`${this.baseUrl}/foods/search/v4`, {
      headers: {
        'Authorization': `Bearer ${token}`
      },
      params: {
        search_expression: searchQuery,
        format: 'json',
        max_results: maxResults
      }
    });

    return response.data.foods?.food || [];
  }

  /**
   * ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ĞšĞ‘Ğ–Ğ£ Ğ¸Ğ· food_description
   * "Per 100g - Calories: 165kcal | Fat: 3.6g | Carbs: 0g | Protein: 31g"
   */
  private parseFoodDescription(description: string): {
    calories: number;
    protein: number;
    fat: number;
    carbs: number;
  } {
    const caloriesMatch = description.match(/Calories:\s*([\d.]+)kcal/i);
    const proteinMatch = description.match(/Protein:\s*([\d.]+)g/i);
    const fatMatch = description.match(/Fat:\s*([\d.]+)g/i);
    const carbsMatch = description.match(/Carbs:\s*([\d.]+)g/i);

    return {
      calories: caloriesMatch ? parseFloat(caloriesMatch[1]) : 0,
      protein: proteinMatch ? parseFloat(proteinMatch[1]) : 0,
      fat: fatMatch ? parseFloat(fatMatch[1]) : 0,
      carbs: carbsMatch ? parseFloat(carbsMatch[1]) : 0,
    };
  }

  /**
   * ĞŸĞ¾Ğ¸ÑĞº Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ‘Ğ”
   */
  async searchLocal(searchQuery: string, limit: number = 20): Promise<Product[]> {
    const result = await query<Product>(`
      SELECT * FROM products
      WHERE name ILIKE $1
        AND is_active = true
      ORDER BY name ASC
      LIMIT $2
    `, [`%${searchQuery}%`, limit]);

    return result.rows;
  }

  /**
   * ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº (Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ‘Ğ” + FatSecret)
   */
  async searchProducts(
    searchQuery: string,
    source: 'local' | 'fatsecret' | 'all' = 'all',
    limit: number = 20
  ): Promise<{ products: Array<Product & { source: 'local' | 'fatsecret' }>; cached: boolean }> {
    const results: Array<Product & { source: 'local' | 'fatsecret' }> = [];

    // ĞŸĞ¾Ğ¸ÑĞº Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ‘Ğ”
    if (source === 'local' || source === 'all') {
      const localProducts = await this.searchLocal(searchQuery, limit);
      results.push(...localProducts.map(p => ({ ...p, source: 'local' as const })));
    }

    // ĞŸĞ¾Ğ¸ÑĞº Ğ² FatSecret (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¸ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚ Ğ½Ğµ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³Ğ½ÑƒÑ‚)
    if ((source === 'fatsecret' || source === 'all') && results.length < limit) {
      const fsProducts = await this.searchFatSecret(searchQuery, limit - results.length);

      for (const fsProduct of fsProducts) {
        const macros = this.parseFoodDescription(fsProduct.food_description);
        results.push({
          fatsecret_id: fsProduct.food_id,
          name: fsProduct.food_name,
          ...macros,
          fiber: 0,
          category: 'other' as any,
          is_perishable: true,
          cooking_ratio: 1.0,
          is_active: true,
          created_at: new Date().toISOString(),
          source: 'fatsecret' as const
        });
      }
    }

    return {
      products: results.slice(0, limit),
      cached: source === 'local'
    };
  }

  /**
   * Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ Ğ¸Ğ· FatSecret Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½ÑƒÑ Ğ‘Ğ”
   */
  async importProduct(fatSecretId: string, userId?: string): Promise<{ product_id: string; already_exists: boolean }> {
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ½Ğµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ»Ğ¸ ÑƒĞ¶Ğµ
    const existing = await query<Product>(`
      SELECT id FROM products WHERE fatsecret_id = $1
    `, [fatSecretId]);

    if (existing.rows.length > 0) {
      return {
        product_id: existing.rows[0].id,
        already_exists: true
      };
    }

    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ
    const token = await this.getAccessToken();
    const response = await axios.get(`${this.baseUrl}/food/v5`, {
      headers: {
        'Authorization': `Bearer ${token}`
      },
      params: {
        food_id: fatSecretId,
        format: 'json'
      }
    });

    const food = response.data.food;

    // Ğ‘ĞµÑ€Ñ‘Ğ¼ Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ñ (100Ğ³)
    const serving = food.servings.serving.find(
      (s: any) => s.metric_serving_amount === '100.0' && s.metric_serving_unit === 'g'
    ) || food.servings.serving[0];

    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ² Ğ‘Ğ”
    const result = await query<{ id: string }>(`
      INSERT INTO products (
        fatsecret_id, name, calories, protein, fat, carbs, fiber,
        category, is_perishable, cooking_ratio, imported_by_user_id
      )
      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)
      RETURNING id
    `, [
      fatSecretId,
      food.food_name,
      parseFloat(serving.calories),
      parseFloat(serving.protein),
      parseFloat(serving.fat),
      parseFloat(serving.carbohydrate),
      parseFloat(serving.fiber || 0),
      this.detectCategory(food.food_name),
      this.detectPerishable(food.food_name),
      1.0,
      userId
    ]);

    return {
      product_id: result.rows[0].id,
      already_exists: false
    };
  }

  private detectCategory(name: string): string {
    // ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ ÑĞ²Ñ€Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğ¼ ÑĞ»Ğ¾Ğ²Ğ°Ğ¼
    const lower = name.toLowerCase();

    if (lower.includes('chicken') || lower.includes('ĞºÑƒÑ€Ğ¸Ñ†Ğ°')) return 'poultry';
    if (lower.includes('beef') || lower.includes('Ğ³Ğ¾Ğ²ÑĞ´Ğ¸Ğ½Ğ°')) return 'meat';
    if (lower.includes('fish') || lower.includes('Ñ€Ñ‹Ğ±Ğ°')) return 'fish';
    if (lower.includes('milk') || lower.includes('Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾') || lower.includes('cheese') || lower.includes('ÑÑ‹Ñ€')) return 'dairy';
    if (lower.includes('egg') || lower.includes('ÑĞ¹Ñ†')) return 'eggs';
    if (lower.includes('rice') || lower.includes('Ñ€Ğ¸Ñ') || lower.includes('oat') || lower.includes('Ğ¾Ğ²Ñ')) return 'grains';
    if (lower.includes('bread') || lower.includes('Ñ…Ğ»ĞµĞ±')) return 'bread';

    return 'other';
  }

  private detectPerishable(name: string): boolean {
    const lower = name.toLowerCase();
    const nonPerishable = ['rice', 'pasta', 'oat', 'flour', 'sugar', 'oil', 'Ñ€Ğ¸Ñ', 'Ğ¼Ğ°ĞºĞ°Ñ€Ğ¾Ğ½', 'Ğ¼ÑƒĞºĞ°', 'ÑĞ°Ñ…Ğ°Ñ€', 'Ğ¼Ğ°ÑĞ»Ğ¾'];
    return !nonPerishable.some(word => lower.includes(word));
  }
}
```

### **Database Schema: FatSecret Cache**

```sql
-- ĞšÑÑˆ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ¸ÑĞºĞ° FatSecret
CREATE TABLE fatsecret_search_cache (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  search_query VARCHAR(255) NOT NULL,
  results JSONB NOT NULL,  -- Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP DEFAULT NOW() + INTERVAL '7 days'
);

CREATE INDEX idx_fatsecret_cache_query ON fatsecret_search_cache(search_query);
CREATE INDEX idx_fatsecret_cache_expires ON fatsecret_search_cache(expires_at);

-- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ fatsecret_id Ğ² products
ALTER TABLE products ADD COLUMN fatsecret_id VARCHAR(50) UNIQUE;
ALTER TABLE products ADD COLUMN imported_by_user_id UUID REFERENCES users(id);
CREATE INDEX idx_products_fatsecret ON products(fatsecret_id);
```

---

---

## ğŸ” ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ FatSecret API

### **Environment Variables**

Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² `.env`:

```bash
# FatSecret API
FATSECRET_CLIENT_ID=54f1eebc60864584bbe6529ff549ed58
FATSECRET_CLIENT_SECRET=b596986f18ba469da864c0b37c1c775f
FATSECRET_ENABLED=true
```

### **Backend Config**

ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `backend/src/config.ts`:

```typescript
const envSchema = z.object({
  // ... existing config

  // FatSecret API
  FATSECRET_CLIENT_ID: z.string().optional(),
  FATSECRET_CLIENT_SECRET: z.string().optional(),
  FATSECRET_ENABLED: z.string().default('false'),
});

export const config = {
  // ... existing config

  fatsecret: {
    clientId: parsed.data.FATSECRET_CLIENT_ID,
    clientSecret: parsed.data.FATSECRET_CLIENT_SECRET,
    enabled: parsed.data.FATSECRET_ENABLED === 'true',
  },
};
```

---

## âœ… Ğ§ĞµĞºĞ»Ğ¸ÑÑ‚ Ğ¿ĞµÑ€ĞµĞ´ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ¼

- [x] ĞÑ€Ñ…Ğ¸Ğ² Ñ€Ğ°ÑĞ¿Ğ°ĞºĞ¾Ğ²Ğ°Ğ½ Ğ¸ Ğ¿Ñ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
- [x] Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ°
- [x] TypeScript Ñ‚Ğ¸Ğ¿Ñ‹ ÑĞ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹
- [x] Ğ¡Ñ…ĞµĞ¼Ğ° Ğ‘Ğ” ÑĞ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°
- [x] ĞŸĞ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ ÑĞ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½
- [x] Ğ“Ğ¸Ğ±Ñ€Ğ¸Ğ´Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ FatSecret ÑĞ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°
- [x] UI/UX Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ° ÑĞ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
- [x] Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ FatSecret API âœ…
- [x] Credentials Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ñ‹ Ğ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ Ğ² Ğ¿Ğ»Ğ°Ğ½
- [ ] Ğ£Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- [ ] ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Phase 1

---

## ğŸš€ ĞŸĞ›ĞĞ Ğ“ĞĞ¢ĞĞ’ Ğš Ğ Ğ•ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ˜!

### **Ğ§Ñ‚Ğ¾ Ñƒ Ğ½Ğ°Ñ ĞµÑÑ‚ÑŒ:**

âœ… ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ 3 Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ°Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:
- USDA FoodData (Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ±Ğ°Ğ·Ğ° 500-1000 Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²)
- FatSecret API (Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸ Ğ² real-time)
- Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ‘Ğ” PostgreSQL (ĞºÑÑˆ, Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸)

âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²:
- Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ğ¿Ñ€Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞµ Ğ¿Ğ»Ğ°Ğ½Ğ°
- Ğ—Ğ°Ğ¼ĞµĞ½Ğ° Ğ¸Ğ½Ğ³Ñ€ĞµĞ´Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² Ñ€ĞµÑ†ĞµĞ¿Ñ‚Ğ°Ñ…
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ² Ğ‘Ğ”
- Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºÑƒ (Ğ‘Ğ”/API)

âœ… Backend Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:
- NutritionDataService Ñ OAuth 2.0
- API endpoints Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¸ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°
- ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ´ĞµĞ´ÑƒĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
- MealPlanGenerator Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹

âœ… Frontend Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:
- ProductSearchModal ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚
- Brutal cyberpunk Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½
- Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¼ UI

âœ… FatSecret API Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½:
- Client ID: 54f1eebc60864584bbe6529ff549ed58
- Client Secret: b596986f18ba469da864c0b37c1c775f
- Ğ›Ğ¸Ğ¼Ğ¸Ñ‚: 5,000 Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²/Ğ´ĞµĞ½ÑŒ (Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾)

### **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑˆĞ°Ğ³Ğ¸:**

1. **Ğ£Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ğ½Ğ°** â† Ğ’Ğ« Ğ—Ğ”Ğ•Ğ¡Ğ¬
2. **Phase 1:** Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ Ñ‚Ğ¸Ğ¿Ñ‹ (2-3 Ğ´Ğ½Ñ)
3. **Phase 2:** Backend Services (3-4 Ğ´Ğ½Ñ)
4. **Phase 3:** Frontend Components (3-4 Ğ´Ğ½Ñ)
5. **Phase 4:** Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ (2 Ğ´Ğ½Ñ)
6. **Phase 5:** Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ (2 Ğ´Ğ½Ñ)

**ĞĞ±Ñ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ: ~12-15 Ğ´Ğ½ĞµĞ¹**

---

**ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ? ğŸ¯**
