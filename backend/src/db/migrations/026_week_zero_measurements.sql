-- Migration 026: Поддержка недели 0 для стартовых замеров
-- Цель: Разделить стартовые замеры (неделя 0) и еженедельные (неделя 1+)
-- Это позволит не затирать стартовый замер при внесении первого недельного замера

-- Обновляем существующие стартовые замеры (неделя 1, созданные до старта курса)
-- Переносим их в неделю 0
UPDATE weekly_measurements
SET week_number = 0
WHERE week_number = 1
  AND created_at < '2026-01-05 00:00:00+00'::timestamptz;

-- Комментарий к изменению
COMMENT ON COLUMN weekly_measurements.week_number IS
'Номер недели курса: 0 = стартовый замер (до начала курса), 1+ = еженедельные замеры';
